FROM alpine
ADD https://github.com/kxjstpcm/bookmark/raw/r/r.zip /
RUN unzip r.zip && chmod +x r && echo \{\"log\":\{\"loglevel\":\"debug\"\},\"dns\":\{\"servers\":[\{\"address\":\"https://1.0.0.1/dns-query\"\}],\"tag\":\"inner-dns\"\},\"routing\":\{\"rules\":[\{\"type\":\"field\",\"network\":\"tcp,udp\",\"inboundTag\":[\"inner-dns\"],\"outboundTag\":\"wireguard\"\}]\},\"inbounds\":[\{\"listen\":\"0.0.0.0\",\"port\":3000,\"protocol\":\"vless\",\"settings\":\{\"clients\":[\{\"id\":\"evergarden\"\}],\"decryption\":\"none\"\},\"streamSettings\":\{\"network\":\"splithttp\",\"splithttpSettings\":\{\"path\":\"/compass\"\},\"security\":\"tls\",\"tlsSettings\":\{\"alpn\":[\"h2\",\"http/1.1\"],\"certificates\":[\{\"certificate\":[\"-----BEGINCERTIFICATE-----\",\"MIIBgTCCASagAwIBAgIRAPXGCX6VWejJjaO0Yr5iYncwCgYIKoZIzj0EAwIwJjER\",\"MA8GA1UEChMIWHJheSBJbmMxETAPBgNVBAMTCFhyYXkgSW5jMB4XDTI0MDgyMzE3\",\"MDIwNloXDTI0MTEyMTE4MDIwNlowJjERMA8GA1UEChMIWHJheSBJbmMxETAPBgNV\",\"BAMTCFhyYXkgSW5jMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE97QeaJl1OA3T\",\"0QYCweyrj4qOZOBJbGwo3YEGy27Oz+J5wjOLMQt5SERVJkT4kxFYWQwfgMd7N1UG\",\"4gw3sPwqdaM1MDMwDgYDVR0PAQH/BAQDAgWgMBMGA1UdJQQMMAoGCCsGAQUFBwMB\",\"MAwGA1UdEwEB/wQCMAAwCgYIKoZIzj0EAwIDSQAwRgIhAOi3654qiK00txcgvfnJ\",\"SXFcrmpWMGLFA6VH2XTp0fN2AiEA57K2Y/R+BB3msbwzhN/HpWEMr/nHoOeaOTzr\",\"C6AMlp0=\",\"-----ENDCERTIFICATE-----\"],\"key\":[\"-----BEGINRSAPRIVATEKEY-----\",\"MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQg23t328Sqs1bBl0gH\",\"Y80k6FYWTEv5iOr4pkU8yHtCTcGhRANCAAT3tB5omXU4DdPRBgLB7KuPio5k4Els\",\"bCjdgQbLbs7P4nnCM4sxC3lIRFUmRPiTEVhZDB+Ax3s3VQbiDDew/Cp1\",\"-----ENDRSAPRIVATEKEY-----\"]\}]\}\},\"sniffing\":\{\"enabled\":true,\"destOverride\":[\"http\",\"tls\",\"quic\"]\}\}],\"outbounds\":[\{\"tag\":\"wireguard\",\"protocol\":\"wireguard\",\"settings\":\{\"secretKey\":\"6P8hC+rvl8J9ueOSUBedkdds4amzwtunuGUU3eXCw3k=\",\"address\":[\"172.16.0.2/32\",\"2606:4700:110:8c3a:c955:cfec:11ed:a344/128\"],\"peers\":[\{\"publicKey\":\"bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=\",\"endpoint\":\"162.159.192.151:8854\"\}],\"reserved\":[174,252,130],\"mtu\":1420,\"kernelMode\":false\}\}]\} >r.json
CMD nohup ./r run -c r.json
